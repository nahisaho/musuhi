# 要件仕様書テンプレート

**プロジェクト**: [プロジェクト名]
**バージョン**: [バージョン番号]
**日付**: [YYYY-MM-DD]
**作成者**: [作成者名]
**ステータス**: [Draft | Review | Approved]

---

## 1. ドキュメント概要

### 1.1 目的
[この要件定義書の目的を簡潔に記述]

### 1.2 スコープ
[この仕様に含まれる内容と含まれない内容]

### 1.3 対象読者
- プロダクトマネージャー
- システムアーキテクト
- ソフトウェア開発者
- テストエンジニア
- QAチーム

### 1.4 参照ドキュメント
- `steering/structure.md` - アーキテクチャパターン
- `steering/tech.md` - 技術スタック
- `steering/product.md` - ビジネスコンテキスト
- `steering/rules/ears-format.ja.md` - EARS形式ガイドライン

---

## 2. ステークホルダー

### 2.1 主要ステークホルダー
- **[役割]**: [名前/説明]
- **[役割]**: [名前/説明]

### 2.2 エンドユーザー
- **[ユーザータイプ]**: [説明]
- **[ユーザータイプ]**: [説明]

---

## 3. 要件

> **注意**: すべての要件はEARS形式（Easy Approach to Requirements Syntax）に従います。
> 詳細は `steering/rules/ears-format.ja.md` を参照してください。

---

### 機能 1: [機能名]

**目的**: [役割]として、[機能]がほしい。なぜなら[利点]だから

**優先度**: [Critical | High | Medium | Low]
**複雑度**: [High | Medium | Low]
**依存関係**: [依存関係をリスト]

#### 受入基準

##### AC-1.1: [イベント駆動要件]
**パターン**: イベント駆動（WHEN）

```
WHEN [トリガーイベント], the [システム/サービス] SHALL [具体的な応答/動作]
```

**例**:
```
WHEN ユーザーが「保存」ボタンをクリックする, the Form Service SHALL すべての必須フィールドを検証する
```

**テスト検証**:
- [ ] ユニットテスト: 検証がトリガーされることを確認
- [ ] 統合テスト: 完全な保存フローを確認
- [ ] E2Eテスト: ユーザーが保存操作を完了できることを確認

---

##### AC-1.2: [状態駆動要件]
**パターン**: 状態駆動（WHILE）

```
WHILE [状態/条件が有効である], the [システム/サービス] SHALL [具体的な振る舞い]
```

**例**:
```
WHILE データ読み込み中である, the UI SHALL ローディングスピナーを表示しフォーム入力を無効にする
```

**テスト検証**:
- [ ] ユニットテスト: ローディング状態管理を確認
- [ ] 統合テスト: UIが状態変更に応答することを確認
- [ ] ビジュアルテスト: スピナーが正しく表示されることを確認

---

##### AC-1.3: [エラー処理要件]
**パターン**: 望ましくない振る舞い（IF...THEN）

```
IF [エラー条件が発生する], THEN the [システム/サービス] SHALL [エラー応答]
```

**例**:
```
IF 検証が失敗する, THEN the Form Service SHALL 「すべての必須フィールドを入力してください」エラーメッセージを表示し、無効なフィールドを赤色でハイライトする
```

**テスト検証**:
- [ ] ユニットテスト: エラー処理ロジックを確認
- [ ] 統合テスト: エラーメッセージ表示を確認
- [ ] E2Eテスト: ユーザーがエラーを確認して修正できることを確認

---

##### AC-1.4: [オプション機能要件]
**パターン**: オプション機能（WHERE）

```
WHERE [機能が有効/設定されている], the [システム/サービス] SHALL [具体的な機能]
```

**例**:
```
WHERE 自動保存が有効である, the Form Service SHALL 30秒ごとに下書きを保存する
```

**テスト検証**:
- [ ] ユニットテスト: 有効時の自動保存ロジックを確認
- [ ] 統合テスト: 機能トグルが機能することを確認
- [ ] E2Eテスト: 自動保存の動作をエンドツーエンドで確認

---

##### AC-1.5: [普遍的要件]
**パターン**: 常に有効（SHALL）

```
The [システム/サービス] SHALL [常に有効な振る舞い]
```

**例**:
```
The Form Service SHALL 機密データをAES-256で暗号化してから送信する
```

**テスト検証**:
- [ ] ユニットテスト: 暗号化が適用されることを確認
- [ ] セキュリティテスト: 暗号化強度を確認
- [ ] 統合テスト: 暗号化されたデータ送信を確認

---

### 機能 2: [機能名]

**目的**: [役割]として、[機能]がほしい。なぜなら[利点]だから

**優先度**: [Critical | High | Medium | Low]
**複雑度**: [High | Medium | Low]
**依存関係**: [依存関係をリスト]

#### 受入基準

##### AC-2.1: [要件タイトル]
**パターン**: [WHEN | WHILE | IF...THEN | WHERE | SHALL]

```
[EARS形式の要件]
```

**テスト検証**:
- [ ] [テストタイプ]: [確認内容]
- [ ] [テストタイプ]: [確認内容]

---

##### AC-2.2: [要件タイトル]
**パターン**: [WHEN | WHILE | IF...THEN | WHERE | SHALL]

```
[EARS形式の要件]
```

**テスト検証**:
- [ ] [テストタイプ]: [確認内容]
- [ ] [テストタイプ]: [確認内容]

---

## 4. 非機能要件

### 4.1 パフォーマンス要件

##### NFR-P.1: 応答時間
```
The [システム] SHALL ユーザーリクエストに対して95パーセンタイルで[X]ms以内に応答する
```

**テスト検証**:
- [ ] パフォーマンステスト: 負荷下での応答時間を測定
- [ ] 監視: 本番環境で95パーセンタイルを追跡

---

##### NFR-P.2: スループット
```
The [システム] SHALL 毎秒少なくとも[X]リクエストを処理する
```

**テスト検証**:
- [ ] 負荷テスト: スループット容量を確認
- [ ] ストレステスト: 限界点を特定

---

### 4.2 セキュリティ要件

##### NFR-S.1: 認証
```
The [システム] SHALL すべてのユーザーアカウントに多要素認証を強制する
```

**テスト検証**:
- [ ] セキュリティテスト: MFA強制を確認
- [ ] ペネトレーションテスト: バイパス試行

---

##### NFR-S.2: データ保護
```
The [システム] SHALL すべての保管データをAES-256で暗号化する
```

**テスト検証**:
- [ ] セキュリティ監査: 暗号化実装を確認
- [ ] コンプライアンステスト: 基準適合を確認

---

### 4.3 信頼性要件

##### NFR-R.1: 可用性
```
The [システム] SHALL 30日間で99.9%の稼働率を維持する
```

**テスト検証**:
- [ ] 監視: 稼働率メトリクスを追跡
- [ ] カオステスト: フォールトトレランスを確認

---

##### NFR-R.2: データバックアップ
```
The [システム] SHALL [X]時間ごとに自動バックアップを実行し30日間保持する
```

**テスト検証**:
- [ ] バックアップテスト: バックアップ作成を確認
- [ ] リカバリテスト: 復元プロセスを確認

---

### 4.4 ユーザビリティ要件

##### NFR-U.1: アクセシビリティ
```
The UI SHALL WCAG 2.1 レベルAA基準に準拠する
```

**テスト検証**:
- [ ] アクセシビリティ監査: 準拠を確認
- [ ] スクリーンリーダーテスト: 互換性を確認

---

##### NFR-U.2: ブラウザサポート
```
The Web Application SHALL Chrome、Firefox、Safari、Edgeの最新2バージョンをサポートする
```

**テスト検証**:
- [ ] クロスブラウザテスト: 互換性を確認
- [ ] ビジュアルリグレッション: 一貫性を確認

---

### 4.5 スケーラビリティ要件

##### NFR-SC.1: 水平スケーリング
```
The [システム] SHALL パフォーマンス低下なく[X]ノードまで水平スケーリングをサポートする
```

**テスト検証**:
- [ ] スケールテスト: スケーリング動作を確認
- [ ] パフォーマンステスト: スケール時の性能を測定

---

## 5. 制約

### 5.1 技術的制約
- [制約の説明]
- [制約の説明]

### 5.2 ビジネス制約
- [制約の説明]
- [制約の説明]

### 5.3 規制上の制約
- [制約の説明]
- [制約の説明]

---

## 6. 前提条件と依存関係

### 6.1 前提条件
- [前提条件の説明]
- [前提条件の説明]

### 6.2 依存関係
- [依存関係の説明]
- [依存関係の説明]

---

## 7. 用語集

| 用語 | 定義 |
|------|------|
| [用語] | [定義] |
| [用語] | [定義] |

---

## 8. 承認

| 役割 | 氏名 | 署名 | 日付 |
|------|------|------|------|
| プロダクトマネージャー | | | |
| システムアーキテクト | | | |
| テックリード | | | |
| QAリード | | | |

---

## 付録 A: EARSパターンクイックリファレンス

### イベント駆動（WHEN）
```
WHEN [イベント], the [システム] SHALL [応答]
```
用途: 特定のイベントやトリガーへの応答

### 状態駆動（WHILE）
```
WHILE [状態], the [システム] SHALL [応答]
```
用途: システム状態に依存する振る舞い

### 望ましくない振る舞い（IF...THEN）
```
IF [エラー条件], THEN the [システム] SHALL [応答]
```
用途: エラー処理と障害シナリオ

### オプション機能（WHERE）
```
WHERE [機能有効], the [システム] SHALL [応答]
```
用途: 条件付きまたは設定可能な機能

### 普遍的（SHALL）
```
The [システム] SHALL [応答]
```
用途: 常に有効な要件

---

## 付録 B: 要件品質チェックリスト

各要件を確定する前に確認：

- [ ] 5つのEARSパターンのいずれかを正しく使用している
- [ ] トリガー/条件が明確に定義されている
- [ ] システム/サービスが明示的に命名されている
- [ ] 「SHALL」を使用している（「すべき」「かもしれない」「だろう」でない）
- [ ] 単一の具体的な振る舞いを記述している
- [ ] テスト可能かつ検証可能である
- [ ] 曖昧な表現がない
- [ ] 明確化の質問なしで実装できる

---

**ドキュメント管理**

| バージョン | 日付 | 作成者 | 変更内容 |
|-----------|------|--------|----------|
| 1.0 | YYYY-MM-DD | [氏名] | 初版 |
